
\section{Proposed method}
\label{sec:proposed}

We evaluate the use of RNNs for the task of transit signal detection. As opposed to CNNs, RNNs can (i) handle arbitrary input sizes and (ii) provide an output at every time step of a given light curve. We make use of property (i) by training the network on light curve segments and applying it to full-length light curves for detection. We make use of property (ii) by training the model to identify exactly those time steps that are part of a transit signal. In other words, the RNN is trained to classify each data point as signal or non-signal.

An important factor in the network's performance is the way in which the input data is preprocessed. Therefore, the question arises which preprocessing steps can or should be considered when using RNNs for this task, and how they affect the modelâ€™s performance. In this work, we evaluate several different preprocessing steps concerning the scaling of the input data and the way data gaps are handled. For example, to address the problem of non-uniform time intervals between measurements, we explore the use of a generative RNN, which is trained to fill in data gaps as it processes through a light curve. 

In experiments using simulated data, we assess whether an RNN-based detection algorithm is a viable and competitive alternative to existing approaches. In the task of monotransit detection, we investigate the question of whether the outputs of the RNN can be made more interpretable, in order to set better thresholds and reduce the amount of false detections. 
To do so, we extend the network to produce confidence outputs in addition to the standard classification outputs at each time step, as proposed by \cite{devries2018learning}. 
The confidence outputs are supposed to indicate the confidence over the corresponding standard outputs at each time step.

In the case of detecting repeating signals, rather than monotransits, additional steps are required. This work investigates two approaches to determine the periodicity in such a case. In combination with the RNN, both of these approaches combine to a novel RNN-based transit detection algorithm, which is able to output $t_0$ and $P$ of candidate transit signals in any given light curve.

The first approach, referred to as PTS-Peak, is inspired by the work of \cite{pearson2018searching}. The probability time series (PTS) refers to the outputs of the RNN over time. Peaks in the PTS would indicate a potential transit event at the corresponding time steps. PTS-Peak uses the average distance between subsequent peaks as a period estimate of the signal. In the search for multiple planets, one could apply this method iteratively, each time removing the most prominent peaks from the PTS. To help resolve ambiguities in determining which PTS peaks belong to which signal, we explore the use of learned signal representations by the RNN.

The second approach, referred to as PTS-Fold, builds on top of existing approaches, where the input, in this case the PTS, is folded over a set of trial periods. For each trial period, a score is given based on the aggregated values within the folded PTS. The best scoring value for the period is used as a period estimate.